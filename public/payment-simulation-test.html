<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ”¯ä»˜æ¨¡æ‹Ÿæµ‹è¯• - Webhook Only</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        h2 {
            color: #666;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        select, input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        button {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px 0;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .btn-warning {
            background-color: #ffc107;
            color: #212529;
        }
        .btn-warning:hover {
            background-color: #e0a800;
        }
        .btn-success {
            background-color: #28a745;
        }
        .btn-success:hover {
            background-color: #218838;
        }
        .btn-danger {
            background-color: #dc3545;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .test-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .test-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        .webhook-data {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .api-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .status-enabled {
            background-color: #d4edda;
            color: #155724;
        }
        .status-disabled {
            background-color: #f8d7da;
            color: #721c24;
        }
        .credits-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        .credits-before, .credits-after {
            display: inline-block;
            margin: 0 10px;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .credits-before {
            background-color: #fff3cd;
            color: #856404;
        }
        .credits-after {
            background-color: #d4edda;
            color: #155724;
        }
        .steps {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
        }
        .steps li {
            counter-increment: step-counter;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        .steps li::before {
            content: counter(step-counter);
            background: #007bff;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: inline-block;
            text-align: center;
            line-height: 20px;
            margin-right: 10px;
            font-size: 12px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª æ”¯ä»˜æ¨¡æ‹Ÿæµ‹è¯•å·¥å…· - Webhook Only</h1>
        
        <div class="info result">
            <strong>ğŸ“‹ æµ‹è¯•è¯´æ˜ï¼š</strong><br>
            â€¢ æ­¤å·¥å…·åªæµ‹è¯•Webhook APIï¼ˆå…¶ä»–æ”¯ä»˜APIå·²ç¦ç”¨ï¼‰<br>
            â€¢ è‡ªåŠ¨ç”ŸæˆUUIDæ ¼å¼çš„æµ‹è¯•ç”¨æˆ·ID<br>
            â€¢ æ¨¡æ‹ŸCreemå‘é€çš„å„ç§webhookäº‹ä»¶<br>
            â€¢ æµ‹è¯•ç§¯åˆ†æ·»åŠ ã€é‡å¤æ£€æŸ¥ã€å¹‚ç­‰æ€§ä¿æŠ¤<br>
            â€¢ éªŒè¯è®¢é˜…å’Œè®¢å•è®°å½•åˆ›å»º
        </div>

        <div class="warning result">
            <strong>âš ï¸ é‡è¦æé†’ï¼š</strong><br>
            â€¢ ç°åœ¨ä¼šè‡ªåŠ¨ç”ŸæˆUUIDæ ¼å¼çš„ç”¨æˆ·ID<br>
            â€¢ å¿…é¡»å…ˆåˆ›å»ºæµ‹è¯•ç”¨æˆ·ï¼Œå¦åˆ™webhookä¼šå¤±è´¥<br>
            â€¢ æµ‹è¯•ç”¨æˆ·åªå­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œä¸æ˜¯çœŸå®ç™»å½•ç”¨æˆ·<br>
            â€¢ è¯·æŒ‰ç…§æµ‹è¯•æ­¥éª¤é¡ºåºæ“ä½œ
        </div>

        <h2>ğŸ”§ APIçŠ¶æ€</h2>
        <div class="api-status status-enabled">
            <span>âœ… Webhook API</span>
            <span>æ´»è·ƒ</span>
        </div>
        <div class="api-status status-disabled">
            <span>âŒ Payment Success Callback</span>
            <span>å·²ç¦ç”¨</span>
        </div>
        <div class="api-status status-disabled">
            <span>âŒ Update User Meta</span>
            <span>å·²ç¦ç”¨</span>
        </div>
        <div class="api-status status-disabled">
            <span>âŒ Subscription Conflict Handler</span>
            <span>å·²ç¦ç”¨</span>
        </div>
    </div>

    <div class="test-grid">
        <!-- å·¦ä¾§ï¼šæµ‹è¯•å‚æ•° -->
        <div class="test-section">
            <h2>ğŸ¯ æµ‹è¯•å‚æ•°</h2>
            
            <div class="form-group">
                <label for="userId">ç”¨æˆ·ID</label>
                <input type="text" id="userId" value="" placeholder="å°†è‡ªåŠ¨ç”ŸæˆUUIDæ ¼å¼ç”¨æˆ·ID">
            </div>

            <div class="form-group">
                <label for="productId">äº§å“ID</label>
                <select id="productId">
                    <option value="prod_7kbzeBzBsEnWbRA0iTh7wf">ä¸€æ¬¡æ€§ç§¯åˆ†åŒ… (500ç§¯åˆ†)</option>
                    <option value="prod_6OoADdBXIm16LRR6TN6sFw">æœˆåº¦è®¢é˜… (500ç§¯åˆ†/æœˆ)</option>
                    <option value="prod_6N9SkBhig3ofomadscbGr7">å¹´åº¦è®¢é˜… (1000ç§¯åˆ†/å¹´)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="eventType">Webhookäº‹ä»¶ç±»å‹</label>
                <select id="eventType">
                    <option value="checkout.completed">checkout.completed - ç»“è´¦å®Œæˆ</option>
                    <option value="subscription.active">subscription.active - è®¢é˜…æ¿€æ´»</option>
                    <option value="subscription.paid">subscription.paid - è®¢é˜…ä»˜è´¹</option>
                    <option value="subscription.cancelled">subscription.cancelled - è®¢é˜…å–æ¶ˆ</option>
                    <option value="subscription.update">subscription.update - è®¢é˜…æ›´æ–°</option>
                    <option value="subscription.trialing">subscription.trialing - è¯•ç”¨æœŸ</option>
                    <option value="refund.created">refund.created - é€€æ¬¾åˆ›å»º</option>
                    <option value="dispute.created">dispute.created - äº‰è®®åˆ›å»º</option>
                </select>
            </div>

            <div class="form-group">
                <label for="orderId">è®¢å•ID</label>
                <input type="text" id="orderId" value="" placeholder="è‡ªåŠ¨ç”Ÿæˆ">
            </div>

            <div class="form-group">
                <label for="subscriptionId">è®¢é˜…ID</label>
                <input type="text" id="subscriptionId" value="" placeholder="è‡ªåŠ¨ç”Ÿæˆ">
            </div>

            <div class="form-group">
                <label for="checkoutId">ç»“è´¦ID</label>
                <input type="text" id="checkoutId" value="" placeholder="è‡ªåŠ¨ç”Ÿæˆ">
            </div>

            <button onclick="generateIds()">ğŸ”„ ç”ŸæˆéšæœºID</button>
            <button onclick="createTestUser()">ğŸ‘¤ åˆ›å»ºæµ‹è¯•ç”¨æˆ·</button>
            <button onclick="sendWebhook()" class="btn-success">ğŸš€ å‘é€Webhook</button>
            <button onclick="sendDuplicateTest()" class="btn-warning">ğŸ” é‡å¤æµ‹è¯•</button>
            <button onclick="checkUserCredits()" class="btn-info">ğŸ’° æŸ¥çœ‹ç”¨æˆ·ç§¯åˆ†</button>
            <button onclick="clearTestResults()" class="btn-danger">ğŸ—‘ï¸ æ¸…é™¤ç»“æœ</button>
        </div>

        <!-- å³ä¾§ï¼šæµ‹è¯•ç»“æœ -->
        <div class="test-section">
            <h2>ğŸ“Š æµ‹è¯•ç»“æœ</h2>
            
            <div id="creditsInfo" class="credits-info" style="display: none;">
                <h4>ç§¯åˆ†å˜åŒ–</h4>
                <div>
                    <span class="credits-before">æµ‹è¯•å‰: <span id="creditsBefore">-</span></span>
                    <span class="credits-after">æµ‹è¯•å: <span id="creditsAfter">-</span></span>
                </div>
            </div>

            <div id="testResults" class="result" style="display: none;">
                <h4>æµ‹è¯•ç»“æœ</h4>
                <div id="testResultsContent"></div>
            </div>

            <div id="webhookData" class="webhook-data" style="display: none;">
                <h4>å‘é€çš„Webhookæ•°æ®</h4>
                <div id="webhookDataContent"></div>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ“‹ æµ‹è¯•æµç¨‹</h2>
        <ol class="steps">
            <li><strong>è®¾ç½®æµ‹è¯•å‚æ•°</strong> - é€‰æ‹©äº§å“ç±»å‹å’Œäº‹ä»¶ç±»å‹</li>
            <li><strong>ç”ŸæˆID</strong> - ç‚¹å‡»"ç”ŸæˆéšæœºID"æŒ‰é’®ï¼ˆç”ŸæˆUUIDæ ¼å¼ç”¨æˆ·IDï¼‰</li>
            <li><strong>åˆ›å»ºæµ‹è¯•ç”¨æˆ·</strong> - ç‚¹å‡»"åˆ›å»ºæµ‹è¯•ç”¨æˆ·"æŒ‰é’®ç¡®ä¿ç”¨æˆ·å­˜åœ¨</li>
            <li><strong>æŸ¥çœ‹åˆå§‹ç§¯åˆ†</strong> - ç‚¹å‡»"æŸ¥çœ‹ç”¨æˆ·ç§¯åˆ†"</li>
            <li><strong>å‘é€Webhook</strong> - ç‚¹å‡»"å‘é€Webhook"æŒ‰é’®</li>
            <li><strong>æ£€æŸ¥ç»“æœ</strong> - æŸ¥çœ‹ç§¯åˆ†å˜åŒ–å’ŒAPIå“åº”</li>
            <li><strong>é‡å¤æµ‹è¯•</strong> - ç‚¹å‡»"é‡å¤æµ‹è¯•"éªŒè¯å¹‚ç­‰æ€§</li>
        </ol>

        <h2>ğŸ” é¢„æœŸè¡Œä¸º</h2>
        <div class="info result">
            <strong>âœ… æ­£å¸¸æƒ…å†µï¼š</strong><br>
            â€¢ æµ‹è¯•ç”¨æˆ·åˆ›å»ºæˆåŠŸï¼ˆUUIDæ ¼å¼ï¼‰<br>
            â€¢ é¦–æ¬¡webhookè°ƒç”¨æˆåŠŸæ·»åŠ ç§¯åˆ†<br>
            â€¢ åˆ›å»ºè®¢é˜…å’Œè®¢å•è®°å½•<br>
            â€¢ è¿”å›æˆåŠŸå“åº”<br><br>
            
            <strong>ğŸ” é‡å¤è°ƒç”¨ï¼š</strong><br>
            â€¢ ç³»ç»Ÿæ£€æµ‹åˆ°é‡å¤è®¢å•<br>
            â€¢ è¿”å›"å·²å¤„ç†"å“åº”<br>
            â€¢ ä¸ä¼šé‡å¤æ·»åŠ ç§¯åˆ†<br><br>
            
            <strong>âŒ å¼‚å¸¸æƒ…å†µï¼š</strong><br>
            â€¢ æ— æ•ˆçš„äº§å“IDæˆ–ç”¨æˆ·IDæ ¼å¼<br>
            â€¢ ç¼ºå°‘å¿…è¦å‚æ•°<br>
            â€¢ æ•°æ®åº“é”™è¯¯æˆ–ç”¨æˆ·ä¸å­˜åœ¨
        </div>
    </div>

    <script>
        const API_BASE = window.location.origin;
        let currentCredits = 0;
        let testOrderId = null;

        // ç”ŸæˆéšæœºID
        function generateIds() {
            const timestamp = Date.now();
            const random = Math.random().toString(36).substring(2, 8);
            
            testOrderId = `order_${timestamp}_${random}`;
            document.getElementById('orderId').value = testOrderId;
            document.getElementById('subscriptionId').value = `sub_${timestamp}_${random}`;
            document.getElementById('checkoutId').value = `checkout_${timestamp}_${random}`;
            
            // ç”Ÿæˆæœ‰æ•ˆçš„UUIDæ ¼å¼ç”¨æˆ·ID
            const userId = generateUUID();
            document.getElementById('userId').value = userId;
            
            showInfo('å·²ç”Ÿæˆæ–°çš„æµ‹è¯•IDï¼ˆåŒ…å«UUIDæ ¼å¼ç”¨æˆ·IDï¼‰');
        }

        // ç”ŸæˆUUID
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        // å‘é€Webhook
        async function sendWebhook() {
            const userId = document.getElementById('userId').value;
            const productId = document.getElementById('productId').value;
            const eventType = document.getElementById('eventType').value;
            const orderId = document.getElementById('orderId').value;
            const subscriptionId = document.getElementById('subscriptionId').value;
            const checkoutId = document.getElementById('checkoutId').value;

            if (!userId || !productId || !eventType) {
                showError('è¯·å¡«å†™å¿…è¦çš„æµ‹è¯•å‚æ•°');
                return;
            }

            // å…ˆè·å–å½“å‰ç§¯åˆ†
            const creditsResponse = await fetchUserCredits(userId);
            const creditsBefore = creditsResponse.success ? creditsResponse.credits : 0;
            currentCredits = creditsBefore;

            // æ„é€ webhookæ•°æ®
            const webhookData = {
                eventType: eventType,
                object: {
                    customer: { id: userId },
                    product: { id: productId },
                    id: subscriptionId || checkoutId,
                    order: orderId ? { id: orderId } : undefined,
                    subscription: subscriptionId ? { id: subscriptionId } : undefined,
                    checkout: checkoutId ? { id: checkoutId } : undefined
                }
            };

            // æ ¹æ®äº‹ä»¶ç±»å‹è°ƒæ•´æ•°æ®ç»“æ„
            if (eventType === 'checkout.completed') {
                webhookData.object.subscription = subscriptionId ? { id: subscriptionId } : undefined;
                webhookData.object.order = orderId ? { id: orderId } : undefined;
            } else if (eventType.startsWith('subscription.')) {
                webhookData.object.id = subscriptionId;
                if (eventType === 'subscription.paid') {
                    webhookData.object.order = orderId ? { id: orderId } : undefined;
                    webhookData.object.checkout = checkoutId ? { id: checkoutId } : undefined;
                }
            }

            // æ˜¾ç¤ºwebhookæ•°æ®
            document.getElementById('webhookDataContent').textContent = JSON.stringify(webhookData, null, 2);
            document.getElementById('webhookData').style.display = 'block';

            try {
                showInfo('æ­£åœ¨å‘é€Webhook...');
                
                const response = await fetch(`${API_BASE}/api/creem/webhook`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'User-Agent': 'Creem-Webhook-Test/1.0'
                    },
                    body: JSON.stringify(webhookData)
                });

                const result = await response.json();

                // è·å–å¤„ç†åçš„ç§¯åˆ†
                const creditsAfterResponse = await fetchUserCredits(userId);
                const creditsAfter = creditsAfterResponse.success ? creditsAfterResponse.credits : creditsBefore;

                // æ˜¾ç¤ºç§¯åˆ†å˜åŒ–
                document.getElementById('creditsBefore').textContent = creditsBefore;
                document.getElementById('creditsAfter').textContent = creditsAfter;
                document.getElementById('creditsInfo').style.display = 'block';

                // æ˜¾ç¤ºç»“æœ
                if (response.ok) {
                    showSuccess('Webhookå‘é€æˆåŠŸ', result);
                } else {
                    showError('Webhookå‘é€å¤±è´¥', result);
                }

            } catch (error) {
                showError('ç½‘ç»œé”™è¯¯', { error: error.message });
            }
        }

        // å‘é€é‡å¤æµ‹è¯•
        async function sendDuplicateTest() {
            if (!testOrderId) {
                showError('è¯·å…ˆå‘é€ä¸€æ¬¡æ­£å¸¸çš„Webhook');
                return;
            }

            showInfo('æ­£åœ¨å‘é€é‡å¤Webhookæµ‹è¯•...');
            
            // ä½¿ç”¨ç›¸åŒçš„å‚æ•°å†æ¬¡å‘é€
            await sendWebhook();
        }

        // è·å–ç”¨æˆ·ç§¯åˆ†
        async function fetchUserCredits(userId) {
            try {
                // å¯¹äºæµ‹è¯•ç”¨æˆ·ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸åŒçš„æ–¹æ³•è·å–ç§¯åˆ†
                if (userId) {
                    // ç›´æ¥æŸ¥è¯¢æ•°æ®åº“è·å–æµ‹è¯•ç”¨æˆ·ç§¯åˆ†
                    const response = await fetch(`${API_BASE}/api/debug/supabase-test`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            action: 'get_user_credits',
                            userId: userId
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        return {
                            success: true,
                            credits: data.credits || 0
                        };
                    }
                }

                // å¯¹äºå·²ç™»å½•ç”¨æˆ·ï¼Œä½¿ç”¨åŸæ¥çš„æ–¹æ³•
                const response = await fetch(`${API_BASE}/api/creem/user-credits`, {
                    method: 'GET',
                    credentials: 'include'
                });

                if (response.ok) {
                    const data = await response.json();
                    return {
                        success: true,
                        credits: data.credits || 0
                    };
                } else {
                    return {
                        success: false,
                        credits: 0
                    };
                }
            } catch (error) {
                return {
                    success: false,
                    credits: 0
                };
            }
        }

        // åˆ›å»ºæµ‹è¯•ç”¨æˆ·
        async function createTestUser() {
            const userId = document.getElementById('userId').value;
            
            if (!userId) {
                showError('è¯·å…ˆç”Ÿæˆç”¨æˆ·ID');
                return;
            }

            try {
                showInfo('æ­£åœ¨åˆ›å»ºæµ‹è¯•ç”¨æˆ·...');
                
                // ä½¿ç”¨Supabase Auth APIåˆ›å»ºæµ‹è¯•ç”¨æˆ·
                const response = await fetch(`${API_BASE}/api/debug/supabase-test`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'create_test_profile',
                        userId: userId,
                        email: `test-${userId.substring(0, 8)}@example.com`,
                        name: `Test User ${userId.substring(0, 8)}`
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showSuccess('æµ‹è¯•ç”¨æˆ·åˆ›å»ºæˆåŠŸ', {
                        userId: userId,
                        email: result.email || `test-${userId.substring(0, 8)}@example.com`,
                        name: result.name || `Test User ${userId.substring(0, 8)}`,
                        credits: result.credits || 0
                    });
                } else {
                    const error = await response.json();
                    showError('åˆ›å»ºæµ‹è¯•ç”¨æˆ·å¤±è´¥', error);
                }
            } catch (error) {
                showError('åˆ›å»ºç”¨æˆ·é”™è¯¯', { error: error.message });
            }
        }

        // æ£€æŸ¥ç”¨æˆ·ç§¯åˆ†
        async function checkUserCredits() {
            const userId = document.getElementById('userId').value;
            
            if (!userId) {
                showError('è¯·è¾“å…¥ç”¨æˆ·ID');
                return;
            }

            try {
                showInfo('æ­£åœ¨æŸ¥è¯¢ç”¨æˆ·ç§¯åˆ†...');
                
                const result = await fetchUserCredits(userId);
                
                if (result.success) {
                    showSuccess('ç§¯åˆ†æŸ¥è¯¢æˆåŠŸ', {
                        userId: userId,
                        credits: result.credits
                    });
                } else {
                    showError('ç§¯åˆ†æŸ¥è¯¢å¤±è´¥', {
                        userId: userId,
                        error: 'ç”¨æˆ·ä¸å­˜åœ¨æˆ–æœªç™»å½•'
                    });
                }
            } catch (error) {
                showError('æŸ¥è¯¢é”™è¯¯', { error: error.message });
            }
        }

        // æ˜¾ç¤ºç»“æœå‡½æ•°
        function showResult(type, title, data) {
            const resultsDiv = document.getElementById('testResults');
            const resultsContent = document.getElementById('testResultsContent');
            
            resultsDiv.className = `result ${type}`;
            resultsDiv.style.display = 'block';
            
            resultsContent.innerHTML = `
                <h4>${title}</h4>
                <pre>${JSON.stringify(data, null, 2)}</pre>
            `;
        }

        function showSuccess(title, data) {
            showResult('success', 'âœ… ' + title, data);
        }

        function showError(title, data) {
            showResult('error', 'âŒ ' + title, data);
        }

        function showInfo(title, data) {
            showResult('info', 'ğŸ“‹ ' + title, data || '');
        }

        // æ¸…é™¤æµ‹è¯•ç»“æœ
        function clearTestResults() {
            document.getElementById('testResults').style.display = 'none';
            document.getElementById('webhookData').style.display = 'none';
            document.getElementById('creditsInfo').style.display = 'none';
            currentCredits = 0;
            testOrderId = null;
            showInfo('æµ‹è¯•ç»“æœå·²æ¸…é™¤');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨ç”ŸæˆID
        document.addEventListener('DOMContentLoaded', function() {
            generateIds();
        });
    </script>
</body>
</html> 